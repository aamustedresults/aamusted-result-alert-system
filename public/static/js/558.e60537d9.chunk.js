"use strict";(self.webpackChunkresults_system=self.webpackChunkresults_system||[]).push([[558],{26558:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var r=t(1413),s=t(93433),i=t(74165),l=t(15861),a=t(29439),u=t(72791),o=t(12258),c=t(64554),d=t(4567),h=t(53767),x=t(93006),f=t(97808),Z=t(94721),p=t(60220),j=t(81153),m=t(46314),v=t(5849),b=t(63515),g=t(6907),y=t(74223),S=t(80184),C=(0,y.Z)((0,S.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchSharp"),w=t(763),k=t.n(w),R=t(16871),I=t(91933),P=t(92506),E=t(76385),W=t(61820);var z=function(e){var n=e.result,t=e.handleRemoveResult;return(0,S.jsxs)("tr",{style:{textAlign:"center"},children:[(0,S.jsx)("td",{children:n.course.id}),(0,S.jsx)("td",{children:n.course.label}),(0,S.jsx)("td",{children:n.score}),(0,S.jsx)("td",{children:n.grade}),(0,S.jsx)("td",{children:(0,S.jsx)(v.Z,{onClick:function(){return t(n.course.id)},children:"Remove"})})]})};var A,T=function(e){var n=e.results,t=e.setResults,r=function(e){var r=n.filter((function(n){return n.course.id!==e}));t(r)};return(0,S.jsx)(h.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,S.jsxs)("table",{width:"100%",children:[(0,S.jsx)("thead",{style:{color:"#fff",backgroundColor:"#8C1438"},children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:"Code"}),(0,S.jsx)("th",{children:"Course"}),(0,S.jsx)("th",{children:"Score"}),(0,S.jsx)("th",{children:"Grade"}),(0,S.jsx)("th",{children:"Action"})]})}),(0,S.jsx)("tbody",{children:n.map((function(e,n){return(0,S.jsx)(z,{result:e,handleRemoveResult:r},n)}))})]})})},Y=t(90110),N=t(85175),L=(t(81724),["100","200","300","400"]),M=["1","2"],B=["2021","2022","2023"];A="https://aamusted-results.herokuapp.com";var D=function(){var e=(0,R.TH)().state,n=(0,u.useTransition)(),t=(0,a.Z)(n,2),y=(t[0],t[1]),w=(0,u.useState)(""),z=(0,a.Z)(w,2),D=z[0],F=z[1],q=(0,u.useState)(""),H=(0,a.Z)(q,2),O=H[0],Q=H[1],V=(0,u.useState)(""),_=(0,a.Z)(V,2),G=_[0],J=_[1],U=(0,u.useState)(null),K=(0,a.Z)(U,2),X=K[0],$=K[1],ee=(0,u.useState)(""),ne=(0,a.Z)(ee,2),te=ne[0],re=ne[1],se=(0,u.useState)(""),ie=(0,a.Z)(se,2),le=ie[0],ae=ie[1],ue=(0,u.useState)(null),oe=(0,a.Z)(ue,2),ce=oe[0],de=oe[1],he=(0,u.useState)(null),xe=(0,a.Z)(he,2),fe=xe[0],Ze=xe[1],pe=(0,u.useState)(null),je=(0,a.Z)(pe,2),me=je[0],ve=je[1],be=(0,u.useState)(0),ge=(0,a.Z)(be,2),ye=ge[0],Se=ge[1],Ce=(0,u.useState)(""),we=(0,a.Z)(Ce,2),ke=we[0],Re=we[1],Ie=(0,u.useState)([]),Pe=(0,a.Z)(Ie,2),Ee=Pe[0],We=Pe[1],ze=(0,u.useState)([]),Ae=(0,a.Z)(ze,2),Te=Ae[0],Ye=Ae[1],Ne=(0,u.useState)("none"),Le=(0,a.Z)(Ne,2),Me=Le[0],Be=Le[1];(0,u.useEffect)((function(){var e=function(e){var n=window.scrollY;Be(n>=220?"block":"none")};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[]),(0,u.useEffect)((function(){k().isEmpty(e)||(J(e.student.fullname),$(e.student.profile),re(e.student.indexNumber))}),[e]),(0,I.useQuery)(["registeredCourses",te,ce,fe],(0,l.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,N.BR)(te));case 1:case"end":return e.stop()}}),e)}))),{enabled:!!te,onSuccess:function(e){var n=[],t=e;ce&&(t=t.filter((function(e){return e.level===ce}))),fe&&(t=t.filter((function(e){return e.semester===Number(fe)})));var r=t.map((function(e){return(0,s.Z)(e.courses)}));k().flatMap(r).map((function(e){return n.push({id:e.course.id,label:e.course.label})})),Ye(n)}});var De=(0,I.useQuery)(["student"],Y.uH,{onError:function(e){alert("Error occured while fetching data")}}),Fe=(0,u.useCallback)((function(){F("");var e={course:me,score:Number(ye),grade:ke};Ee.find((function(n){return n.course.id===e.course.id}))?F("Course already exists.Please remove before!"):We([].concat((0,s.Z)(Ee),[e]))}),[me,ke,ye,Ee]);(0,u.useEffect)((function(){var e=Number(ye),n="";e>79&&e<=100&&(n="A"),e>74&&e<80&&(n="B+"),e>69&&e<75&&(n="B"),e>64&&e<70&&(n="C+"),e>59&&e<65&&(n="C"),e>54&&e<60&&(n="D+"),e>49&&e<55&&(n="D"),e>44&&e<50&&(n="E"),e<45&&(n="F"),Re(n)}),[ye]);var qe={indexNumber:te,year:le,level:ce,semester:fe,results:Ee},He=((0,I.useMutation)(E.f6),function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),Oe=function(e){Q(e.currentTarget.value);var n=e.currentTarget.value;if(""===n||0===n.length)return J(""),re(""),void $(null);y((function(){var e=De.data.filter((function(e){return e.indexNumber.lastIndexOf(n)>-1}));if(0===e.length)return J(""),re(""),void $(null);J(e[0].fullname),re(e[0].indexNumber),$(e[0].profile)}))};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.ql,{children:(0,S.jsx)("title",{children:"AAMUSTED Results System | Results Entry"})}),(0,S.jsx)("section",{className:"data-entry-container",children:(0,S.jsx)(P.J9,{initialValues:qe,onSubmit:He,enableReinitialize:!0,children:function(e){var n=e.handleSubmit,t=e.isSubmitting,s=e.errors,i=(e.values,e.touched);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.Z,{sx:{display:Me,width:"100%",height:80,backgroundColor:"#fff",transition:"display 500ms ease-in-out",boxShadow:"0 1px 3px rgba(0,0,0,0.15)",position:"sticky",top:160,zIndex:100,padding:1},children:(0,S.jsx)(o.Z,{disabled:0===Ee.length,variant:"contained",loading:t,onClick:n,children:"Save Results"})}),(0,S.jsxs)(W.Z,{children:[(0,S.jsx)(d.Z,{variant:"h4",children:"Result Entry"}),(0,S.jsxs)(h.Z,{spacing:3,paddingY:3,children:[(0,S.jsx)(x.Z,{fullWidth:!0,placeholder:"Search for Student",inputMode:"search",type:"search",value:O,onChange:Oe,InputProps:{endAdornment:(0,S.jsx)(f.Z,{position:"end",children:(0,S.jsx)(C,{})})}}),(0,S.jsxs)(c.Z,{children:[(0,S.jsxs)(c.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingY:1,gap:1},children:[(0,S.jsx)(d.Z,{children:"Personal Information"}),(0,S.jsx)(o.Z,{disabled:0===Ee.length,variant:"contained",onClick:n,children:"Save Results"})]}),(0,S.jsx)(Z.Z,{}),(0,S.jsxs)(h.Z,{paddingY:1,direction:"row",spacing:3,children:[(0,S.jsx)(p.Z,{src:null===X||""===X||void 0===X?null:"".concat(A,"/images/").concat(X),sx:{width:60,height:60}}),(0,S.jsxs)(h.Z,{children:[(0,S.jsx)(d.Z,{variant:"h6",color:"slateblue",children:G}),(0,S.jsx)(d.Z,{variant:"body",children:te})]})]})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)(d.Z,{paddingY:1,children:"Academic Information"}),(0,S.jsx)(Z.Z,{}),(0,S.jsxs)(j.ZP,{container:!0,sx:{display:"flex",justifyContent:{xs:"center",md:"space-between"},alignItems:"center",paddingY:2,gap:1},children:[(0,S.jsx)(j.ZP,{item:!0,children:(0,S.jsx)(m.Z,{disablePortal:!0,options:B,freeSolo:!0,value:le,onChange:function(e,n){return ae(n)},sx:{minWidth:150,width:300},renderInput:function(e){return(0,S.jsx)(x.Z,(0,r.Z)((0,r.Z)({label:"Academic Year"},e),{},{id:"year",size:"small",placeholder:"Academic Year",fullWidth:!0,error:Boolean(i.year&&s.year),helperText:i.year&&s.year&&s.year}))}})}),(0,S.jsx)(j.ZP,{item:!0,children:(0,S.jsx)(m.Z,{disablePortal:!0,options:L,value:ce,onChange:function(e,n){return de(n)},sx:{minWidth:150,width:300},renderInput:function(e){return(0,S.jsx)(x.Z,(0,r.Z)((0,r.Z)({label:"Level"},e),{},{id:"level",size:"small",fullWidth:!0,placeholder:"Level"}))}})}),(0,S.jsx)(j.ZP,{item:!0,children:(0,S.jsx)(m.Z,{disablePortal:!0,options:M,value:fe,onChange:function(e,n){return Ze(n)},sx:{minWidth:150,width:300},renderInput:function(e){return(0,S.jsx)(x.Z,(0,r.Z)((0,r.Z)({label:"Semester"},e),{},{id:"semester",size:"small",placeholder:"Semester",fullWidth:!0}))}})})]})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)(d.Z,{paddingY:1,children:"Results Information"}),(0,S.jsx)(Z.Z,{}),(0,S.jsxs)(j.ZP,{container:!0,sx:{display:"flex",justifyContent:{xs:"center",md:"flex-start"},alignItems:"center",paddingY:2,gap:1},children:[(0,S.jsx)(j.ZP,{item:!0,children:(0,S.jsx)(m.Z,{disablePortal:!0,options:Te,value:me,isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return ve(n)},sx:{minWidth:150,width:300},renderInput:function(e){return(0,S.jsx)(x.Z,(0,r.Z)((0,r.Z)({label:"Course"},e),{},{id:"course",size:"small",fullWidth:!0,placeholder:"Course",helperText:0===Te.length?"No courses available":"".concat(Te.length," course(s) available")}))}})}),(0,S.jsx)(j.ZP,{item:!0,children:(0,S.jsx)(x.Z,{label:"Score",id:"score",size:"small",type:"number",fullWidth:!0,placeholder:"Score",value:ye,sx:{minWidth:150,width:300},onChange:function(e){return Se(e.currentTarget.value)},helperText:"Scores should be from 0-100"})})]}),(0,S.jsx)(v.Z,{variant:"contained",disabled:""===me||null===me,size:"large",sx:{minWidth:200,color:"#fff"},onClick:Fe,children:"Add Results"})]})]}),D&&(0,S.jsx)(b.Z,{severity:"error",onClose:function(){return F("")},children:D}),(0,S.jsx)(T,{results:Ee,setResults:We})]})]})}})})]})}}}]);
//# sourceMappingURL=558.e60537d9.chunk.js.map