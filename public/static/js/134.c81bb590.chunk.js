"use strict";(self.webpackChunkresults_system=self.webpackChunkresults_system||[]).push([[134],{75134:function(e,r,n){n.r(r),n.d(r,{default:function(){return U}});var s=n(74165),t=n(15861),i=n(29439),a=n(72791),l=n(15617),o=n.n(l),d=n(54270),c=n(4567),u=n(64554),h=n(48312),x=n(94721),f=n(63515),m=n(4841),p=n(93006),j=n(82626),v=n(5849),g=n(85771),Z=n(53767),w=n(91933),S=n(92506),b=n(81724),y=n(12258),C=n(43504),z=n(73767),A=n(74223),P=n(80184),R=(0,A.Z)((0,P.jsx)("path",{d:"M3 3v18h18V3H3zm14 12.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"DisabledByDefaultSharp"),E=n(81639),k=n(38820),D=n(4208),_=n(89712),B=n(27321),M=n(61820),T=n(90038);var U=function(){var e=(0,w.useQueryClient)(),r=(0,a.useState)({severity:"",msg:""}),n=(0,i.Z)(r,2),l=n[0],A=n[1],U=(0,a.useState)(!0),W=(0,i.Z)(U,2),N=W[0],q=W[1],F=(0,a.useState)(""),H=(0,i.Z)(F,2),L=H[0],V=H[1],I=(0,a.useState)(""),Q=(0,i.Z)(I,2),O=Q[0],G=Q[1],J=(0,a.useState)(""),X=(0,i.Z)(J,2),Y=X[0],K=X[1],$=(0,a.useState)(""),ee=(0,i.Z)($,2),re=ee[0],ne=ee[1],se=(0,a.useState)(""),te=(0,i.Z)(se,2),ie=te[0],ae=te[1],le=function(){q(!0),V(""),K(""),G("")},oe=(0,w.useQuery)(["users"],B.Rf,{suspense:function(){return(0,P.jsx)("div",{children:"loading"})},select:function(e){return e.map((function(e){return{_id:e._id,username:e.username,role:e.role,active:e.active,createdAt:e.createdAt}}))}}),de={username:L,email:Y,role:O,password:re,confirmPassword:ie},ce=(0,b.Ry)().shape({username:(0,b.Z_)().trim().required(),email:(0,b.Z_)().trim().required().email(),password:(0,b.Z_)().trim().required().min(8,"Password Should be at least 8 characters long"),confirmPassword:(0,b.Z_)().trim().required().oneOf([(0,b.iH)("password"),null],"Passwords do not match")}),ue=(0,w.useMutation)(B.cn),he=(0,w.useMutation)(B.NZ);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(d.q,{children:(0,P.jsx)("title",{children:"AAMUSTED Results System | Register"})}),(0,P.jsx)("section",{className:"register-user-container",children:(0,P.jsxs)(M.Z,{children:[(0,P.jsx)(c.Z,{variant:"h5",children:"Register New User"}),(0,P.jsx)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,P.jsxs)(h.Z,{children:[(0,P.jsx)(C.rU,{to:"register",children:"Home"}),(0,P.jsx)(c.Z,{children:"Register"})]})}),(0,P.jsx)(x.Z,{sx:{marginBottom:2}}),l.msg&&(0,P.jsx)(f.Z,{severity:l.severity,onClose:function(){A({severity:"",msg:""})},children:l.msg}),(0,P.jsxs)(u.Z,{sx:{width:"100%",display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:{xs:"center",md:"space-between"},alignItems:{xs:"center",md:"stretch"},gap:{xs:2,md:6}},children:[(0,P.jsx)(S.J9,{initialValues:de,validationSchema:ce,onSubmit:function(e,r){delete e.confirmPassword,ue.mutateAsync(e,{onSettled:function(){r.setSubmitting(!1)},onSuccess:function(){var e=(0,t.Z)((0,s.Z)().mark((function e(n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(A({severity:"success",msg:"New User Added!!!"}),r.resetForm());case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onError:function(e){A({severity:"error",msg:e})}})},enableReinitialize:!0,children:function(e){var r=e.errors,n=e.touched,s=e.handleSubmit,t=e.isSubmitting;return(0,P.jsxs)(m.Z,{sx:{width:300,borderTop:"solid 2px #5aa7a7",paddingX:2,paddingY:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:3,boxShadow:"0px 0px 13px 0px rgb(82 63 105 / 10%)",borderRadius:"10px"},children:[(0,P.jsx)(p.Z,{variant:"filled",label:"Username",placeholder:"Enter Username here",fullWidth:!0,size:"small",value:L,onChange:function(e){return V(e.target.value)},error:Boolean(n.username&&r.username),helperText:r.username&&r.username}),(0,P.jsx)(p.Z,{type:"email",variant:"filled",label:"Email Address",placeholder:"Enter email address here",fullWidth:!0,size:"small",value:Y,onChange:function(e){return K(e.target.value)},error:Boolean(n.email&&r.email),helperText:r.email&&r.email}),(0,P.jsx)(p.Z,{select:!0,variant:"filled",label:"Select Role",placeholder:"Role",fullWidth:!0,size:"small",value:O,onChange:function(e){return G(e.target.value)},error:Boolean(n.role&&r.role),helperText:r.role&&r.role,children:(0,P.jsx)(j.Z,{value:"administrator",children:"Administrator"})}),N?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(p.Z,{variant:"filled",type:"password",label:"Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:re,onChange:function(e){return ne(e.target.value)},error:Boolean(n.password&&r.password),helperText:r.password&&r.password}),(0,P.jsx)(p.Z,{variant:"filled",type:"password",label:"Confirm Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:ie,onChange:function(e){return ae(e.target.value)},error:Boolean(n.confirmPassword&&r.confirmPassword),helperText:r.confirmPassword&&r.confirmPassword}),(0,P.jsx)(y.Z,{loading:t,variant:"contained",fullWidth:!0,onClick:s,children:"Register"})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(y.Z,{loading:t,variant:"contained",fullWidth:!0,onClick:s,children:"Save Changes"}),(0,P.jsx)(v.Z,{color:"secondary",fullWidth:!0,onClick:le,children:"Cancel"})]})]})}}),(0,P.jsx)(u.Z,{sx:{flexGrow:1},children:(0,P.jsx)(o(),{icons:T.P,title:"Users",data:oe.data?oe.data:[],columns:[{title:"ID",field:"_id",hidden:!0},{title:"Username",field:"username"},{title:"Role",field:"role"},{title:"Account Status",field:"active",render:function(e){return(0,P.jsx)(g.Z,{size:"small",label:e.active?"Active":"Disabled",color:e.active?"success":"error"})}},{title:"Options",sorting:!1,render:function(r){return(0,P.jsxs)(z.v2,{children:[(0,P.jsx)(z.j2,{style:{backgroundColor:"transparent",outline:"none",border:"none"},children:(0,P.jsx)(E.Z,{})}),(0,P.jsxs)(z.qy,{style:{zIndex:"100"},children:[(0,P.jsxs)(z.sN,{onSelect:function(){return function(r){var n={id:r._id,active:!r.active};he.mutateAsync(n,{onSettled:function(){e.invalidateQueries("user")},onSuccess:function(r){e.invalidateQueries("user"),alert(r)},onError:function(e){}})}(r)},children:[(0,P.jsx)(R,{fontSize:"32px"}),(0,P.jsx)("span",{children:!0===r.active?"Disable Account":"Enable Account"})]}),(0,P.jsx)(z.sN,{onSelect:function(){q(!1),V(r.username),K(r.email),G(r.role)},children:(0,P.jsxs)(Z.Z,{direction:"row",children:[(0,P.jsx)(k.Z,{fontSize:"32px"}),(0,P.jsx)("span",{children:"Edit"})]})}),(0,P.jsxs)(z.sN,{onSelect:function(){console.log("deleted")},children:[(0,P.jsx)(D.Z,{fontSize:"32px"}),(0,P.jsx)("span",{children:"Delete"})]})]})]})}}],isLoading:oe.isLoading,style:{borderTop:"solid 2px #5aa7a7",fontSize:"13px",boxShadow:"0px 0px 13px 0px rgb(82 63 105 / 10%)",borderRadius:"10px"},actions:[{position:"toolbar",tooltip:"Refresh",icon:function(){return(0,P.jsx)(_.Z,{})},isFreeAction:!0,onClick:function(){oe.refetch()}}],options:{pageSizeOptions:[5,10,20,50,100],selection:!0,exportButton:!0}})})]})]})})]})}},4208:function(e,r,n){var s=n(74223),t=n(80184);r.Z=(0,s.Z)((0,t.jsx)("path",{d:"M6 21h12V7H6v14zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteSharp")},38820:function(e,r,n){var s=n(74223),t=n(80184);r.Z=(0,s.Z)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);
//# sourceMappingURL=134.c81bb590.chunk.js.map