"use strict";(self.webpackChunkresults_system=self.webpackChunkresults_system||[]).push([[965],{50965:function(e,r,n){n.r(r),n.d(r,{default:function(){return $}});var t=n(29439),s=n(72791),i=n(15617),a=n.n(i),o=n(6907),l=n(4567),u=n(64554),c=n(48312),d=n(94721),m=n(63515),h=n(5849),f=n(85771),p=n(53767),x=n(91933),v=n(43504),Z=n(73767),j=n(74223),g=n(80184),S=(0,j.Z)((0,g.jsx)("path",{d:"M3 3v18h18V3H3zm14 12.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"DisabledByDefaultSharp"),w=n(68087),y=n(81639),C=n(38820),b=n(4208),B=n(89712),E=n(27321),z=n(61820),P=n(90038),A=n(74165),U=n(15861),D=n(13967),R=n(5574),_=n(65661),k=n(4899),W=n(93006),q=n(82626),T=n(77386),M=n(92506),N=n(81724),O=n(12258),Q=n(4799),F=n.n(Q);var I=function(e){var r=e.open,n=e.setOpen,i=(0,x.useQueryClient)(),a=(0,D.Z)().palette,o=(0,s.useState)(""),l=(0,t.Z)(o,2),u=l[0],c=l[1],d=(0,s.useState)(""),m=(0,t.Z)(d,2),f=m[0],p=m[1],v=(0,s.useState)(""),Z=(0,t.Z)(v,2),j=Z[0],S=Z[1],w=(0,s.useState)(""),y=(0,t.Z)(w,2),C=y[0],b=y[1],B=(0,s.useState)(""),z=(0,t.Z)(B,2),P=z[0],Q=z[1],I={username:u,email:j,role:f,password:C,confirmPassword:P},V=(0,N.Ry)().shape({username:(0,N.Z_)().trim().required().matches(/^[a-zA-Z0-9]+$/,"Username should not contain white spaces and special characters!"),email:(0,N.Z_)().trim().required().email(),password:(0,N.Z_)().trim().required().min(8,"Password Should be at least 8 characters long"),confirmPassword:(0,N.Z_)().trim().required().oneOf([(0,N.iH)("password"),null],"Passwords do not match")}),H=(0,x.useMutation)(E.cn);return(0,g.jsxs)(R.Z,{open:r,onClose:function(){return n(!1)},maxWidth:"xs",fullWidth:!0,children:[(0,g.jsx)(_.Z,{children:"Add New User"}),(0,g.jsx)(M.J9,{initialValues:I,validationSchema:V,onSubmit:function(e,r){delete e.confirmPassword,H.mutateAsync(e,{onSettled:function(){i.invalidateQueries(["user"]),r.setSubmitting(!1)},onSuccess:function(){var e=(0,U.Z)((0,A.Z)().mark((function e(n){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(F().fire({icon:"success",iconColor:a.primary.main,title:"Success",text:"User added successfully!!",confirmButtonColor:a.primary.main}),r.resetForm());case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onError:function(e){F().fire({icon:"error",title:"Error",text:e,confirmButtonColor:"#f00"})}})},enableReinitialize:!0,children:function(e){var r=e.errors,t=e.touched,s=e.handleSubmit,i=e.handleBlur,a=e.isSubmitting;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(k.Z,{children:[(0,g.jsx)(W.Z,{label:"Username",placeholder:"Enter Username here",fullWidth:!0,size:"small",value:u,onBlur:i("username"),onChange:function(e){return c(e.target.value)},error:Boolean(t.username&&r.username),helperText:r.username&&r.username,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{type:"email",label:"Email Address",placeholder:"Enter email address here",fullWidth:!0,size:"small",value:j,onBlur:i("email"),onChange:function(e){return S(e.target.value)},error:Boolean(t.email&&r.email),helperText:r.email&&r.email,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{select:!0,label:"Select Role",placeholder:"Role",fullWidth:!0,size:"small",value:f,onChange:function(e){return p(e.target.value)},error:Boolean(t.role&&r.role),helperText:r.role&&r.role,sx:{marginBottom:2},children:(0,g.jsx)(q.Z,{value:"administrator",children:"Administrator"})}),(0,g.jsx)(W.Z,{type:"password",label:"Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:C,onBlur:i("password"),onChange:function(e){return b(e.target.value)},error:Boolean(t.password&&r.password),helperText:r.password&&r.password,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{type:"password",label:"Confirm Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:P,onBlur:i("confirmPassword"),onChange:function(e){return Q(e.target.value)},error:Boolean(t.confirmPassword&&r.confirmPassword),helperText:r.confirmPassword&&r.confirmPassword,sx:{marginBottom:2}})]}),(0,g.jsxs)(T.Z,{children:[(0,g.jsx)(O.Z,{loading:a,variant:"contained",onClick:s,children:"Register"}),(0,g.jsx)(h.Z,{color:"secondary",onClick:function(){return n(!1)},children:"Cancel"})]})]})}})]})},V=n(763),H=n.n(V),L=n(99873);var J=function(e){var r=e.open,n=e.setOpen,i=(0,x.useQueryClient)(),a=(0,s.useContext)(L.D).customState,o=(0,D.Z)().palette,l=(0,s.useState)(""),u=(0,t.Z)(l,2),c=u[0],d=u[1],m=(0,s.useState)(""),f=(0,t.Z)(m,2),p=f[0],v=f[1],Z=(0,s.useState)("administrator"),j=(0,t.Z)(Z,2),S=j[0],w=j[1],y=(0,s.useState)(""),C=(0,t.Z)(y,2),b=C[0],B=C[1];(0,s.useEffect)((function(){var e,r,n,t;H().isEmpty(a.userEditData)||(d(null===a||void 0===a||null===(e=a.userEditData)||void 0===e?void 0:e._id),v(null===a||void 0===a||null===(r=a.userEditData)||void 0===r?void 0:r.username),B(null===a||void 0===a||null===(n=a.userEditData)||void 0===n?void 0:n.email),w(null===a||void 0===a||null===(t=a.userEditData)||void 0===t?void 0:t.role))}),[a.userEditData]);var z={id:c,username:p,email:b,role:S},P=(0,N.Ry)().shape({username:(0,N.Z_)().trim().required().matches(/^[a-zA-Z0-9]+$/,"Username should not contain white spaces and special characters"),email:(0,N.Z_)().trim().required().email(),role:(0,N.Z_)().trim().required()}),Q=(0,x.useMutation)(E.Nq);return(0,g.jsxs)(R.Z,{open:r,onClose:function(){return n(!1)},maxWidth:"xs",fullWidth:!0,children:[(0,g.jsx)(_.Z,{children:"Edit User Info"}),(0,g.jsx)(M.J9,{initialValues:z,validationSchema:P,onSubmit:function(e,r){Q.mutateAsync(e,{onSettled:function(){i.invalidateQueries(["user"]),r.setSubmitting(!1)},onSuccess:function(){var e=(0,U.Z)((0,A.Z)().mark((function e(n){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(F().fire({icon:"success",iconColor:o.primary.main,title:"Success",text:"User info updated!!!",confirmButtonColor:o.primary.main}),r.resetForm());case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onError:function(e){}})},enableReinitialize:!0,children:function(e){var r=e.errors,t=e.touched,s=e.handleSubmit,i=e.isSubmitting;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(k.Z,{children:[(0,g.jsx)(W.Z,{label:"Username",placeholder:"Enter Username here",fullWidth:!0,size:"small",value:""!==p?p:"",onChange:function(e){return v(e.target.value)},error:Boolean(t.username&&r.username),helperText:r.username&&r.username,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{type:"email",label:"Email Address",placeholder:"Enter email address here",fullWidth:!0,size:"small",value:""!==b?b:"",onChange:function(e){return B(e.target.value)},error:Boolean(t.email&&r.email),helperText:r.email&&r.email,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{select:!0,label:"Select Role",placeholder:"Role",fullWidth:!0,size:"small",value:S,onChange:function(e){return w(e.target.value)},error:Boolean(t.role&&r.role),helperText:r.role&&r.role,sx:{marginBottom:2},children:(0,g.jsx)(q.Z,{value:"administrator",children:"Administrator"})})]}),(0,g.jsxs)(T.Z,{children:[(0,g.jsx)(O.Z,{loading:i,variant:"contained",onClick:s,children:"Save Changes"}),(0,g.jsx)(h.Z,{color:"secondary",onClick:function(){return n(!1)},children:"Cancel"})]})]})}})]})};var Y=function(e){var r=e.open,n=e.setOpen,i=(0,x.useQueryClient)(),a=(0,s.useContext)(L.D).customState,o=(0,D.Z)().palette,l=(0,s.useState)(""),u=(0,t.Z)(l,2),c=u[0],d=u[1],m=(0,s.useState)(""),f=(0,t.Z)(m,2),p=f[0],v=f[1],Z=(0,s.useState)(""),j=(0,t.Z)(Z,2),S=j[0],w=j[1];(0,s.useEffect)((function(){H().isEmpty(null===a||void 0===a?void 0:a.userId)||d(null===a||void 0===a?void 0:a.userId)}),[a.userId]);var y={id:c,password:p,confirmPassword:S},C=(0,N.Ry)().shape({password:(0,N.Z_)().trim().required().min(8,"Password Should be at least 8 characters long"),confirmPassword:(0,N.Z_)().trim().required().oneOf([(0,N.iH)("password"),null],"Passwords do not match")}),b=(0,x.useMutation)(E.aN);return(0,g.jsxs)(R.Z,{open:r,onClose:function(){return n(!1)},maxWidth:"xs",fullWidth:!0,children:[(0,g.jsx)(_.Z,{children:"Update User Password"}),(0,g.jsx)(M.J9,{initialValues:y,validationSchema:C,onSubmit:function(e,r){b.mutateAsync(e,{onSettled:function(){i.invalidateQueries(["user"]),r.setSubmitting(!1)},onSuccess:function(){var e=(0,U.Z)((0,A.Z)().mark((function e(n){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(F().fire({icon:"success",iconColor:o.primary.main,title:"Success",text:"User password updated!!!",confirmButtonColor:o.primary.main}),r.resetForm());case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onError:function(e){F().fire({icon:"error",iconColor:o.primary.main,title:"Success",text:e,confirmButtonColor:o.primary.main})}})},enableReinitialize:!0,children:function(e){var r=e.errors,t=e.touched,s=e.handleSubmit,i=e.isSubmitting;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(k.Z,{children:[(0,g.jsx)(W.Z,{type:"password",label:"Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:p,onChange:function(e){return v(e.target.value)},error:Boolean(t.password&&r.password),helperText:r.password&&r.password,sx:{marginBottom:2}}),(0,g.jsx)(W.Z,{type:"password",label:"Confirm Password",placeholder:"Enter Password here",fullWidth:!0,size:"small",value:S,onChange:function(e){return w(e.target.value)},error:Boolean(t.confirmPassword&&r.confirmPassword),helperText:r.confirmPassword&&r.confirmPassword,sx:{marginBottom:2}})]}),(0,g.jsxs)(T.Z,{children:[(0,g.jsx)(O.Z,{loading:i,variant:"contained",onClick:s,children:"Save Changes"}),(0,g.jsx)(h.Z,{color:"secondary",onClick:function(){return n(!1)},children:"Cancel"})]})]})}})]})};var $=function(){var e=(0,x.useQueryClient)(),r=(0,s.useContext)(L.D).customDispatch,n=(0,s.useState)(!1),i=(0,t.Z)(n,2),j=i[0],A=i[1],U=(0,s.useState)(!1),D=(0,t.Z)(U,2),R=D[0],_=D[1],k=(0,s.useState)(!1),W=(0,t.Z)(k,2),q=W[0],T=W[1],M=(0,s.useState)({severity:"",msg:""}),N=(0,t.Z)(M,2),O=N[0],Q=N[1],F=(0,x.useQuery)(["user"],E.Rf,{select:function(e){return e.map((function(e){return{_id:e._id,username:e.username,email:e.email,role:e.role,active:e.active,createdAt:e.createdAt}}))}}),V=(0,x.useMutation)(E.NZ);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.ql,{children:(0,g.jsx)("title",{children:"AAMUSTED Results System | Register"})}),(0,g.jsx)(I,{open:j,setOpen:A}),(0,g.jsx)(J,{open:R,setOpen:_}),(0,g.jsx)(Y,{open:q,setOpen:T}),(0,g.jsx)("section",{className:"register-user-container",children:(0,g.jsxs)(z.Z,{children:[(0,g.jsx)(l.Z,{variant:"h4",children:" New User"}),(0,g.jsx)(l.Z,{variant:"body2",children:"Add new user to the system"}),(0,g.jsx)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,g.jsxs)(c.Z,{children:[(0,g.jsx)(v.rU,{to:"/info/register",children:"Home"}),(0,g.jsx)(l.Z,{children:"Register"})]})}),(0,g.jsx)(d.Z,{sx:{marginBottom:2}}),O.msg&&(0,g.jsx)(m.Z,{severity:O.severity,onClose:function(){return Q({msg:""})},children:O.msg}),(0,g.jsx)(u.Z,{width:"100%",display:"flex",justifyContent:"flex-end",paddingY:1,children:(0,g.jsx)(h.Z,{variant:"contained",color:"secondary",startIcon:(0,g.jsx)(w.Z,{}),sx:{paddingY:1},onClick:function(){return A(!0)},children:"New User"})}),(0,g.jsx)(u.Z,{children:(0,g.jsx)(a(),{icons:P.P,title:"Users",data:F.data?F.data:[],columns:[{title:"ID",field:"_id",hidden:!0},{title:"Username",field:"username"},{title:"Email Address",field:"email"},{title:"Role",field:"role"},{title:"Account Status",field:"active",render:function(e){return(0,g.jsx)(f.Z,{size:"small",label:e.active?"Active":"Disabled",color:e.active?"success":"error"})}},{title:"Options",sorting:!1,render:function(n){return(0,g.jsxs)(Z.v2,{children:[(0,g.jsx)(Z.j2,{style:{backgroundColor:"transparent",outline:"none",border:"none"},children:(0,g.jsx)(y.Z,{})}),(0,g.jsxs)(Z.qy,{style:{zIndex:"100"},children:[(0,g.jsxs)(Z.sN,{onSelect:function(){return function(r){var n={id:r._id,active:!r.active};V.mutateAsync(n,{onSettled:function(){e.invalidateQueries(["user"])},onSuccess:function(r){e.invalidateQueries(["user"]),Q({severity:"success",msg:r})},onError:function(e){Q({severity:"error",msg:e})}})}(n)},children:[(0,g.jsx)(S,{fontSize:"32px"}),(0,g.jsx)("span",{children:!0===n.active?"Disable Account":"Enable Account"})]}),(0,g.jsx)(Z.sN,{onSelect:function(){r({type:"userId",payload:n._id}),T(!0)},children:(0,g.jsxs)(p.Z,{direction:"row",children:[(0,g.jsx)(C.Z,{fontSize:"32px"}),(0,g.jsx)("span",{children:"Change Password"})]})}),(0,g.jsx)(Z.sN,{onSelect:function(){r({type:"EditUser",payload:n}),_(!0)},children:(0,g.jsxs)(p.Z,{direction:"row",children:[(0,g.jsx)(C.Z,{fontSize:"32px"}),(0,g.jsx)("span",{children:"Edit"})]})}),(0,g.jsxs)(Z.sN,{onSelect:function(){console.log("deleted")},children:[(0,g.jsx)(b.Z,{fontSize:"32px"}),(0,g.jsx)("span",{children:"Delete"})]})]})]})}}],isLoading:F.isLoading,style:{borderTop:"solid 2px #8C1438",fontSize:"13px",boxShadow:"0px 0px 13px 0px rgb(82 63 105 / 10%)",borderRadius:"10px"},actions:[{position:"toolbar",tooltip:"Refresh",icon:function(){return(0,g.jsx)(B.Z,{})},isFreeAction:!0,onClick:function(){F.refetch()}}],options:{pageSizeOptions:[5,10,20,50,100],selection:!0,exportButton:!0}})})]})})]})}},68087:function(e,r,n){var t=n(74223),s=n(80184);r.Z=(0,t.Z)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add")},4208:function(e,r,n){var t=n(74223),s=n(80184);r.Z=(0,t.Z)((0,s.jsx)("path",{d:"M6 21h12V7H6v14zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteSharp")},38820:function(e,r,n){var t=n(74223),s=n(80184);r.Z=(0,t.Z)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")}}]);
//# sourceMappingURL=965.cb914c60.chunk.js.map